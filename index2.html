<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ESCRW — safe deals</title>
  <style>
    :root{--egg-color:#bbb;--egg-size:0.95rem}
    html,body{height:100%;margin:0;padding:0}
    body{
      /* Чёрный фон — убрал лишние изображения */
      background:#000;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      color:#fff;overflow:hidden;user-select:none;cursor:none;
    }

    *{cursor:none!important}

    .wrap{height:100vh;display:flex;align-items:center;justify-content:center;position:relative}

    /* Логотип */
    .logo{width:60vmin;max-width:720px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-18deg);filter:drop-shadow(0 25px 60px rgba(0,0,0,0.8));touch-action:none}

    /* Пасхалка */
    .easter-egg{position:absolute;bottom:40px;text-align:center;font-size:var(--egg-size);color:var(--egg-color);font-weight:600}
    a{color:inherit;text-decoration:none}

    .typing-wrap{position:relative;display:inline-block;white-space:nowrap;font-size:0.95rem;line-height:1;vertical-align:middle}

    /* базовый белый текст */
    .base{color:#fff;display:inline-block;padding:0 2px}

    /* highlight: абсолютный слой с белым фоном и чёрным текстом; ширина управляется JS */
    .highlight{position:absolute;left:0;top:0;height:100%;display:inline-block;overflow:hidden;background:#fff;color:#000;padding:0 2px;border-right:2px solid var(--egg-color);box-sizing:content-box;pointer-events:none}

    /* caret — мигающая палка, движется при печати */
    .caret{display:inline-block;width:2px;height:1.05em;background:#fff;vertical-align:middle;margin-left:6px;animation:caretBlink 1s steps(1,start) infinite}
    @keyframes caretBlink{0%,50%,100%{opacity:1}25%,75%{opacity:0}}

    .second-line{display:block;margin-top:6px;color:#888;font-size:0.8rem}

    /* кастомный курсор-кружок с mix-blend-mode для автоматической инверсии */
    .cursor{position:fixed;top:0;left:0;width:12px;height:12px;border-radius:50%;background:#fff;pointer-events:none;transform:translate(-50%,-50%);z-index:9999;will-change:transform,background-color;mix-blend-mode:difference;box-shadow:0 6px 20px rgba(0,0,0,0.35);transition:transform 160ms cubic-bezier(.2,.8,.2,1),width 160ms ease,height 160ms ease}
    .cursor--down{transform:translate(-50%,-50%) scale(1.6)}
    .cursor--hover{transform:translate(-50%,-50%) scale(1.4)}

    @media (max-width:420px){.logo{width:86vmin}.typing-wrap{font-size:1rem}}
  </style>
</head>
<body>
  <div class="wrap">
    <img class="logo" src="https://i.ibb.co/NgBFYzzq/Chat-GPT-Image-17-2025-21-47-46.png" alt="ESCRW логотип" draggable="false">

    <div class="easter-egg" aria-hidden="false">
      <a href="https://t.me/EscrwRobot" target="_blank">
        <span class="typing-wrap" id="typingWrap">
          <span class="base" id="baseText"></span>
          <span class="highlight" id="highlightText"></span>
          <span class="caret" id="caret"></span>
        </span>
      </a>
      <a class="second-line" href="https://t.me/suderza" target="_blank">big thank @suderza for the advertising</a>
    </div>
  </div>

  <div class="cursor" id="cursor"></div>

  <script>
    // ---------- Typing + per-letter highlight + erase sequence ----------
    (function(){
      const words = ['haha,','lol,','best deals in ESCRW!'];
      const base = document.getElementById('baseText');
      const highlight = document.getElementById('highlightText');
      const caret = document.getElementById('caret');
      const wrap = document.getElementById('typingWrap');

      // вспомогательный span для точного измерения ширины текста
      const measurer = document.createElement('span');
      document.body.appendChild(measurer);
      measurer.style.position='absolute';measurer.style.left='-9999px';measurer.style.top='-9999px';measurer.style.visibility='hidden';

      // применяем те же шрифты/стили, чтобы измерение точно совпадало
      function syncMeasurerStyles(){
        const cs = getComputedStyle(base);
        measurer.style.font = cs.font;
        measurer.style.letterSpacing = cs.letterSpacing;
        measurer.style.fontWeight = cs.fontWeight;
        measurer.style.fontSize = cs.fontSize;
        measurer.style.padding = cs.padding;
        measurer.style.lineHeight = cs.lineHeight;
      }
      syncMeasurerStyles();
      window.addEventListener('resize', syncMeasurerStyles);

      function measureTextWidth(text){
        measurer.textContent = text || '\u200b'; // zero-width space if empty
        return measurer.getBoundingClientRect().width;
      }

      // настройки скорости (можешь подправить)
      const charDelay = 80; // время между вводом символов
      const highlightDelay = 60; // скорость выделения по буквам
      const eraseDelay = 40; // скорость удаления
      const pauseAfterFull = 700; // пауза когда слово полностью напечатано

      async function sleep(ms){return new Promise(res=>setTimeout(res,ms));}

      async function runSequence(){
        while(true){
          for(const word of words){
            // печать по буквам
            for(let i=1;i<=word.length;i++){
              const part = word.slice(0,i);
              base.textContent = part; // белый текст
              highlight.textContent = part; // чёрный текст внутри белой области
              const w = Math.ceil(measureTextWidth(part));
              highlight.style.width = w + 'px';
              // перемещаем caret в конец
              caret.style.display='inline-block';
              caret.style.marginLeft = '6px';
              caret.style.transform = 'translateY(0)';
              // позиция caret: мы просто оставляем его inline — width of base controls it
              await sleep(charDelay);
            }

            await sleep(pauseAfterFull);

            // теперь по буквам выделяем дальше (если нужно — но уже выделено до full). добавим небольшую задержку
            // задержка чтобы подчеркнуть выделение
            await sleep(140);

            // пауза — затем стираем по буквам
            for(let i=word.length;i>=0;i--){
              const part = word.slice(0,i);
              base.textContent = part;
              highlight.textContent = part;
              const w = Math.ceil(measureTextWidth(part));
              highlight.style.width = w + 'px';
              await sleep(eraseDelay);
            }

            // очистка
            base.textContent = '';
            highlight.textContent = '';
            highlight.style.width = '0px';
            await sleep(160);
          }
        }
      }

      runSequence();
    })();

    // ---------- Smooth draggable logo (transform) ----------
    (function(){
      const logo = document.querySelector('.logo');
      let dragging=false, sx=0, sy=0, tx=0, ty=0;
      const down=(e)=>{dragging=true;const ev=e.touches?e.touches[0]:e; sx=ev.clientX-tx; sy=ev.clientY-ty; logo.style.transition='none'};
      const move=(e)=>{ if(!dragging) return; const ev=e.touches?e.touches[0]:e; tx=ev.clientX-sx; ty=ev.clientY-sy; logo.style.transform = `translate(calc(-50% + ${tx}px), calc(-50% + ${ty}px)) rotate(-18deg)`};
      const up=()=>{ if(!dragging) return; dragging=false; logo.style.transition='transform 0.12s linear'};
      logo.addEventListener('mousedown',down); window.addEventListener('mousemove',move); window.addEventListener('mouseup',up);
      logo.addEventListener('touchstart',down,{passive:false}); window.addEventListener('touchmove',move,{passive:false}); window.addEventListener('touchend',up);
    })();

    // ---------- Custom cursor with mix-blend-mode inversion + inertia ----------
    (function(){
      const cursor = document.getElementById('cursor');
      let mouseX = window.innerWidth/2, mouseY = window.innerHeight/2;
      let curX = mouseX, curY = mouseY;
      const lerp = (a,b,t)=> a + (b-a)*t;

      window.addEventListener('mousemove', e=>{ mouseX = e.clientX; mouseY = e.clientY; });
      window.addEventListener('mousedown', ()=> cursor.classList.add('cursor--down'));
      window.addEventListener('mouseup', ()=> cursor.classList.remove('cursor--down'));

      // hover scale on links
      document.querySelectorAll('a').forEach(a=>{
        a.addEventListener('mouseenter', ()=> cursor.classList.add('cursor--hover'));
        a.addEventListener('mouseleave', ()=> cursor.classList.remove('cursor--hover'));
      });

      function raf(){
        curX = lerp(curX, mouseX, 0.16);
        curY = lerp(curY, mouseY, 0.16);
        cursor.style.transform = `translate(${curX}px, ${curY}px) translate(-50%, -50%)`;
        requestAnimationFrame(raf);
      }
      raf();

      // resize handler to keep things correct
      window.addEventListener('resize', ()=>{});
    })();

  </script>
</body>
</html>
